(1) Controllability check:
[[  1.16701537e+15  -7.59205100e+10   4.20747941e+13  -2.73718213e+09
    1.51693596e+12  -9.86828818e+07   5.46904912e+10  -3.55763455e+06
    1.97174136e+09  -1.28185165e+05   7.10836030e+07  -4.61410132e+03
    2.56121254e+06  -1.62419085e+02   9.21922439e+04  -5.65924002e+00
    3.24514869e+03  -2.00000000e-04   1.13069000e+02   0.00000000e+00]
 [  1.98841556e+14  -1.29355218e+10   7.16889036e+12  -4.66347100e+08
    2.58459248e+11  -1.68058951e+07   9.31788587e+09  -6.05124317e+05
    3.35791407e+08  -2.14511411e+04   1.20907168e+07  -7.49872716e+02
    4.28598874e+05  -8.37050066e+00   1.49822439e+04  -8.00000000e-04
    1.66878500e+02   1.00000000e+00   0.00000000e+00   0.00000000e+00]
 [  5.51520741e+15  -3.58792875e+11   1.98841556e+14  -1.29355218e+10
    7.16889036e+12  -4.66347100e+08   2.58459248e+11  -1.68058951e+07
    9.31788587e+09  -6.05124317e+05   3.35791407e+08  -2.14511411e+04
    1.20907168e+07  -7.49872716e+02   4.28598874e+05  -8.37050066e+00
    1.49822439e+04  -8.00000000e-04   1.66878500e+02   1.00000000e+00]]
rank = 3
(2) find steering input sequence
Now this should be identical to the Control_matrix:
[[1167015368525795.0, -75920510047.588898, 42074794117935.531, -2737182126.0588894, 1516935958641.54, -98682881.845621124, 54690491177.83783, -3557634.5463748951, 1971741355.7324281, -128185.16484201369, 71083603.011710331, -4614.1013163616899, 2561212.5365959113, -162.41908498988616, 92192.243884958632, -5.6592400199999879, 3245.1486864000026, -0.00020000000000564011, 113.06899999999978, 1.0824674490095276e-15], [198841555524954.16, -12935521816.681305, 7168890362174.915, -466347100.00023896, 258459248141.32849, -16805895.124099694, 9317885868.0176277, -605124.31722035806, 335791407.39885145, -21451.141129532403, 12090716.841759814, -749.87271610960215, 428598.87441530492, -8.3705006599999177, 14982.243945700004, -0.00080000000001456684, 166.8784999999983, 1.000000000000004, 2.5579538487363607e-13, -1.0963452368173421e-15], [5515207412361815.0, -358792874766.76672, 198841555524954.09, -12935521816.681301, 7168890362174.9131, -466347100.0002389, 258459248141.32837, -16805895.12409969, 9317885868.0176277, -605124.31722035771, 335791407.39885134, -21451.141129532403, 12090716.841759812, -749.87271610960192, 428598.87441530492, -8.3705006600000083, 14982.243945699995, -0.00079999999999931515, 166.87850000000003, 0.99999999999999967]]
Xf = [[0.0], [0.0], [0.0]]
A10Xo = [[-5092110177578.116], [-867617630342.9067], [-24064844862684.574]]
Xf - A10Xo = [[5092110177578.116], [867617630342.9067], [24064844862684.574]]
U = [[0.0043633448767650407], [7.5378920882940292e-09], [4.8358924686908722e-07], [4.2659576138248667e-07], [-1.5459954738616943e-07], [-6.4992491388693452e-09], [-8.5317587945610285e-06], [2.4115024643833749e-08], [1.3009412214159966e-07], [-1.5981527212716173e-09], [-4.8228685045614839e-07], [1.3969483347864298e-09], [3.1965100788511336e-08], [-1.6019541249079339e-10], [-2.7938085622736253e-08], [8.4426687863015104e-11], [3.2041498343460262e-09], [-1.3145262656166778e-11], [-1.6885195464055869e-09], [5.2840509745522013e-12]]
See the simulation result:
h(t,x,u) = [ 0.02387942  0.08783102  0.11384511]
h(t,x,u) = [ 0.04674999  0.08953041  0.22721648]
h(t,x,u) = [ 0.06897661  0.09236759  0.34166801]
h(t,x,u) = [ 0.09087787  0.09636078  0.45869429]
h(t,x,u) = [ 0.11747108  0.10157773  0.58672335]
h(t,x,u) = [ 0.1394019   0.10806533  0.71314037]
h(t,x,u) = [ 0.16193178  0.1158517   0.8468102 ]
h(t,x,u) = [ 0.1853321   0.12501718  0.98931885]
h(t,x,u) = [ 0.20986185  0.13565823  1.14230714]
h(t,x,u) = [ 0.2357641   0.14788802  1.30747784]
