(1) Controllability check:
[[-0.70710678 -0.70710678  0.70710678  0.70710678 -0.70710678 -0.70710678
   0.70710678  0.          0.          0.        ]
 [-0.70710678  0.70710678  0.70710678 -0.70710678 -0.70710678  0.70710678
   0.70710678  0.          0.          0.        ]
 [ 0.70710678  0.70710678 -0.70710678 -0.70710678  0.70710678  0.70710678
  -0.70710678 -0.70710678  0.70710678  0.        ]
 [ 0.70710678 -0.70710678 -0.70710678  0.70710678  0.70710678 -0.70710678
  -0.70710678  0.70710678  0.70710678  0.        ]
 [ 0.          0.          0.          0.          0.          0.          0.
   0.          0.          1.        ]]
rank = 5
(2) find steering input sequence
Now this should be identical to the Control_matrix:
[[-0.70710678118654802, -0.70710678118654779, 0.70710678118654802, 0.70710678118654757, -0.70710678118654802, -0.70710678118654757, 0.70710678118654802, -4.5395984892795619e-16, -3.3306690738754696e-16, 0.0], [-0.70710678118654746, 0.70710678118654768, 0.70710678118654746, -0.70710678118654757, -0.70710678118654768, 0.70710678118654757, 0.70710678118654768, -1.3976494198548301e-15, -2.2204460492503131e-16, 0.0], [0.70710678118654791, 0.70710678118654802, -0.70710678118654813, -0.70710678118654768, 0.70710678118654802, 0.70710678118654768, -0.70710678118654802, -0.70710678118654802, 0.70710678118654757, 0.0], [0.70710678118654813, -0.70710678118654802, -0.70710678118654757, 0.70710678118654768, 0.70710678118654791, -0.70710678118654768, -0.70710678118654791, 0.70710678118654724, 0.70710678118654724, 0.0], [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.0]]
Xf = [[1.15], [1.15], [0.1], [0.1], [1]]
A5Xo = [[0.5553603672697958], [-0.5553603672697958], [-0.5553603672697958], [0.5553603672697958], [0.0]]
Xf - A5Xo = [[0.5946396327302041], [1.7053603672697957], [0.6553603672697957], [-0.4553603672697958], [1.0]]
U = [[-0.40658639918226475], [0.26179938779914941], [0.40658639918226475], [-0.26179938779914963], [-0.40658639918226491], [0.26179938779914969], [0.4065863991822648], [8.8817841970012523e-16], [1.7677669529663713], [1.0]]
See the simulation result:
h(t,x,u) = [ 1.01404706  1.01556914  0.94539816]
h(t,x,u) = [ 1.04199006  1.04898614  0.94539816]
h(t,x,u) = [ 1.06583733  1.07740244  0.98728607]
h(t,x,u) = [ 1.08615721  1.1016257   0.94539816]
h(t,x,u) = [ 1.10345371  1.12225025  0.98728607]
